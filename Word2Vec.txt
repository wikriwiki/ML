#ì½”ë© í™˜ê²½ì…ë‹ˆë‹¤. CPUì‚¬ìš©
from google.colab import drive

# ğŸ“‚ ë“œë¼ì´ë¸Œ ë§ˆìš´íŠ¸
drive.mount('/content/drive') #--->ìê¸° êµ¬ê¸€ ë“œë¼ì´ë¸Œë¡œ ìˆ˜ì •


!pip uninstall -y numpy scipy
!pip install numpy==1.24.4 scipy==1.10.1 gensim==4.3.3
# ì‹¤í–‰í›„ ëœ¨ëŠ”ì°½ ë¬´ì‹œí•˜ê³  ì•„ë˜ ì½”ë“œ ì‹¤í–‰


#---------------------------------------------------------------
import pandas as pd
import numpy as np
from gensim.models import Word2Vec

# 1ë‹¨ê³„: CSV íŒŒì¼ ë¡œë“œ
df = pd.read_csv("/content/drive/MyDrive/movie/final_boxoffice.csv")

# 2ë‹¨ê³„: ë°°ìš° ë¦¬ìŠ¤íŠ¸ ì „ì²˜ë¦¬ (íŒŒì´í”„ '|' ê¸°ì¤€ ë¶„ë¦¬ ë° ê³µë°± ì œê±°)
df['actor_list'] = df['actors'].fillna("").apply(lambda x: [a.strip() for a in x.split('|') if a.strip()])

# 3ë‹¨ê³„: Word2Vec í•™ìŠµìš© ë°ì´í„° êµ¬ì„± ë° ëª¨ë¸ í›ˆë ¨
actor_sentences = df['actor_list'].tolist()

model = Word2Vec(
    sentences=actor_sentences,
    vector_size=8,      # ì„ë² ë”© ì°¨ì› ìˆ˜ ----> ëŠ˜ë¦´ìˆ˜ë¡ í‘œí˜„ë ¥ì´ ì»¤ì§€ê³  ê³¼ì í•© ì—¬ì§€ê°€ ìˆì§€ë§Œ ëŠ˜ë¦¬ëŠ”ê²Œ ê´€ê³„ì„±ì„ ë³¼ë•Œ íš¨ê³¼ì ì´ì˜€ìŒ 64ê¹Œì§€ ëŠ˜ë ¤ë´„
    window=3,           # ë¬¸ë§¥ ìœˆë„ìš° í¬ê¸°  --------------> ì¢Œìš°ë¡œ ëª‡ê°œê¹Œì§€ì˜ ë‹¨ì–´ë¥¼ ë¬¸ë§¥ìœ¼ë¡œ ë³¼ê±´ì§€ì— ëŒ€í•œ ë¶€ë¶„ 2ë¡œë„ ì¶©ë¶„
    min_count=2,        # ìµœì†Œ ë“±ì¥ íšŸìˆ˜ í•„í„°ë§  ---------------> ë“±ì¥ìˆ˜ê°€ 1ë²ˆ ì´í•˜ë©´ í•™ìŠµì— ì°¸ì—¬ê°€ ì•ˆëŒ
    sg=1,               # skip-gram (1) vs CBOW (0)  ---------->  sg=1: Skip-Gram, sg=0: CBOW (Continuous Bag of Words) 1ë¡œ í–ˆì„ë•Œ ì €ëŠ” ì˜ë¨
                        # Skip-Gram ->ì¤‘ì‹¬ ë‹¨ì–´ë¡œ ì£¼ë³€ ë‹¨ì–´ë¥¼ ì˜ˆì¸¡í•¨ , CBOW (Continuous Bag of Words) ->ì£¼ë³€ ë‹¨ì–´ë“¤ë¡œ ì¤‘ì‹¬ ë‹¨ì–´ë¥¼ ì˜ˆì¸¡.
    epochs=30,          # ì—í¬í¬ë¥¼ ëŠ˜ë ¤ê°€ë©° í•™ìŠµì‹œí‚¤ë©´ ì ì  ì™¸êµ­ì¸ ì´ë¦„ì´ ì‚¬ë¼ì ¸ê°„ë‹¤... íš¨ê³¼ëŠ” ìˆì—ˆë‹¤  .
    negative=10,        # negative sampling ê°œìˆ˜
    seed=42
)

print("âœ… Word2Vec ì„ë² ë”© í•™ìŠµ ì™„ë£Œ")
#--------------------------------------------------------------------




#ê´€ê³„ì„± ì˜ˆì¸¡ ì½”ë“œ
def get_similar_actors(actor_name, model, topn=10):
    try:
        similar_actors = model.wv.most_similar(actor_name, topn=topn)
        print(f"âœ… '{actor_name}'ì™€ ìœ ì‚¬í•œ ë°°ìš° Top {topn}:")
        for i, (name, score) in enumerate(similar_actors, 1):
            print(f"{i}. {name} (ìœ ì‚¬ë„: {score:.4f})")
        return similar_actors
    except KeyError:
        print(f"âŒ '{actor_name}'ëŠ” í•™ìŠµëœ ëª¨ë¸ì— ì—†ìŠµë‹ˆë‹¤.")
        return []



get_similar_actors("ë§ˆë™ì„", model)


#ëª¨ë¸ í•™ìŠµì— ì‚¬ìš©ëœ ë°°ìš°ìˆ˜ ì¶œë ¥
print("âœ… ì‹¤ì œ í•™ìŠµëœ ë°°ìš° ìˆ˜:", len(model.wv.index_to_key))
print("ğŸï¸ í‰ê·  ë°°ìš° ìˆ˜ (ë°°ìš° ë¦¬ìŠ¤íŠ¸ ê¸¸ì´):", np.mean([len(s) for s in actor_sentences]))

